import numpy as np 
import pandas as pd
import matplotlib.pyplot as plt 
import seaborn as sns

# Import Dataset
df = pd.read_csv("C:\\Users\\priya\\Downloads\\Diwali Sales Data.csv", encoding='latin1')
df.shape

df.head()

# Data Cleaning
df.info()

#drop unrelated/blank column
df.drop(['Status', 'unnamed1'], axis = 1, inplace= True)

#check null values
pd.isnull(df).sum()

#drop null values
df.dropna(inplace= True)

df.shape

#change data type
df['Amount']= df['Amount'].astype('int')

df['Amount'].dtypes

df.columns

#rename column
df.rename(columns = {'Marital-status':'Shaadi'})

#describe() method returns description of the data in the dataframe
df.describe()

# use describe() for specific column
df[['Age', 'Orders', 'Amount']].describe()

# Explanatory Data Analysis
# Gender
df.columns

ax = sns.countplot(x= 'Gender', data= df)
for bars in ax.containers:
    ax.bar_label(bars)

df.groupby(['Gender'], as_index = False)['Amount'].sum().sort_values(by = 'Amount', ascending= False)

Sales_gen = df.groupby(['Gender'], as_index = False)['Amount'].sum().sort_values(by = 'Amount', ascending= False)
sns.barplot(x = 'Gender', y = 'Amount', data = Sales_gen)
#from the above graph we can see that most of the buyers are female and even the purchasing power of females are freater then mwn

# Age
df.columns
ax = sns.countplot(data = df, x = 'Age Group')
ax = sns.countplot(data = df, x = 'Age Group', hue = 'Gender')

for bars in ax.containers:
    ax.bar_label(bars)

#Total Amount Vs Age Group
Sales_age = df.groupby(['Age Group'], as_index= False)['Amount'].sum().sort_values(by = 'Amount', ascending = False)

sns.barplot(x = 'Age Group', y = 'Amount', data = Sales_age)
# from above graoph we can see that most of the buyers are age group between 26-35 yrs females

# State
df.columns
# total numbers of orders from top  states
sales_state = df.groupby(['State'], as_index= False)['Orders'].sum().sort_values(by = 'Orders', ascending = False).head(11)

sns.set(rc = {'figure.figsize':(17, 5)})
sns.barplot(data = sales_state, x = 'State', y = 'Orders')

# total amount/sales from states
sales_state = df.groupby(['State'], as_index= False)['Amount'].sum().sort_values(by = 'Amount', ascending = False).head(11)

sns.set(rc = {'figure.figsize':(17, 5)})
sns.barplot(data = sales_state, x = 'State', y = 'Amount')
# from the above graph we can see that most of the sales/amount  are from utter pradesh, maharashtra and karnataka

# Marital Status
ax = sns.countplot(data = df, x = 'Marital_Status')

sns.set(rc = {'figure.figsize':(10, 5)})
for bars in ax.containers:
    ax.bar_label(bars)

sales_state = df.groupby(['Marital_Status', 'Gender'], as_index=  False)['Amount'].sum().sort_values(by = 'Amount', ascending = False)

sns.set(rc = {'figure.figsize':(8,5)})
sns.barplot(data = sales_state, x= 'Marital_Status', y = 'Amount', hue = 'Gender')
# from the above graph we can see that most of buyers are married(women) and they have high purchaising power

# Occupation
ax = sns.countplot(data = df, x = 'Occupation')

sns.set(rc = {'figure.figsize':(20,5)})
for bars in ax.containers:
    ax.bar_label(bars)

sales_state = df.groupby(['Occupation'], as_index= False)['Amount'].sum().sort_values(by = 'Amount', ascending = False).head(11)

sns.set(rc = {'figure.figsize':(17, 5)})
sns.barplot(data = sales_state, x = 'Occupation', y = 'Amount')
# from the above graph we can see that most of buyers are working in IT, Healthcare, Aviation

# Product Category
ax = sns.countplot(data = df, x = 'Product_Category')


sns.set(rc = {'figure.figsize':(30, 8)})
for bars in ax.containers:
    ax.bar_label(bars)


sales_state = df.groupby(['Product_Category'], as_index= False)['Amount'].sum().sort_values(by = 'Amount', ascending = False).head(11)

sns.set(rc = {'figure.figsize':(30, 10)})
sns.barplot(data = sales_state, x = 'Product_Category', y = 'Amount')
# from the above graph we can see that most sold products are from food, clothing and apparel category

sales_state = df.groupby(['Product_ID'], as_index= False)['Amount'].sum().sort_values(by = 'Amount', ascending = False).head(8)

sns.set(rc = {'figure.figsize':(30, 10)})
sns.barplot(data = sales_state, x = 'Product_ID', y = 'Amount')


# Conclusion

#Married women age group 26-35 years from up, maharastra working in IT, Healthcare and Aviation are more likely buy
#products from food, clothing and apparel

Thank you





